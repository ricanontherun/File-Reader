#define CATCH_CONFIG_MAIN

#include "test_header.h"
#include <string>
#include "../file.hpp"

TEST_CASE("Reader::Open", "[open]") {
    using File::Reader;

    SECTION("It can open files using a const char * path") {
        const char *file_path = "../data/file";
        Reader reader;
        File::STATUS status = reader.Open(file_path);

        REQUIRE(File::StatusOk(status));
    }

    SECTION("It can open files using a std::string path") {
        std::string file_path = "../data/file";
        Reader reader;
        File::STATUS status = reader.Open(file_path);

        REQUIRE(File::StatusOk(status));
    }

    SECTION("It returns an appropriate status when given a non-existing file path.") {
        Reader reader;
        File::STATUS status = reader.Open("../data/nope");

        REQUIRE(File::StatusError(status));
        REQUIRE(File::StatusAccessError(status));
    }

    SECTION("It fails when trying to open a non-regular file") {
        Reader reader;
        File::STATUS status = reader.Open("../data");

        REQUIRE(File::StatusError(status));
        REQUIRE(File::StatusTypeError(status));
    }
}
